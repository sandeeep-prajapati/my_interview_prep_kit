Simulating the launch trajectory of a small rocket involves modeling its motion through the atmosphere and into space, accounting for factors like gravity, drag, and thrust. Python is a versatile tool for this kind of simulation, and libraries like NumPy, SciPy, and Matplotlib can help with numerical integration and data visualization. Here's a guide on setting up a simple Python simulation for a rocket's vertical launch trajectory.

---

### Steps to Simulate the Rocket Launch Trajectory

#### 1. **Define Physical Parameters**
   - **Rocket mass (m)**: Rocket's total mass, which decreases as fuel burns.
   - **Thrust (T)**: Force generated by the rocket engine.
   - **Drag coefficient (Cd)**: A measure of aerodynamic drag based on the rocket’s shape.
   - **Cross-sectional area (A)**: Rocket’s cross-sectional area facing the direction of travel.
   - **Air density (ρ)**: Varies with altitude but is around 1.225 kg/m³ at sea level.
   - **Gravity (g)**: 9.81 m/s² (although it decreases slightly with altitude).

#### 2. **Define the Equations of Motion**
   Use Newton’s second law to model the vertical motion:

   \[
   F = m \cdot a = T - D - m \cdot g
   \]

   where:
   - \( F \) is the net force,
   - \( D = \frac{1}{2} \cdot \rho \cdot v^2 \cdot Cd \cdot A \) is the drag force,
   - \( v \) is the rocket’s velocity,
   - \( g \) is the acceleration due to gravity.

#### 3. **Implement the Simulation with Numerical Integration**
   Use Euler’s method or a more accurate integrator like `scipy.integrate.solve_ivp` to compute the position and velocity over time.

#### 4. **Analyze Results**
   Plot the altitude, velocity, and acceleration profiles over time to understand the rocket’s trajectory.

---

### Python Code Example

Here’s a simple example of how to set up and run the simulation using Python.

```python
import numpy as np
import matplotlib.pyplot as plt
from scipy.integrate import solve_ivp

# Rocket parameters
mass_initial = 50.0           # Initial mass (kg)
mass_fuel = 20.0              # Fuel mass (kg)
burn_rate = 0.2               # Fuel consumption rate (kg/s)
thrust = 500.0                # Thrust (N)
Cd = 0.5                      # Drag coefficient
A = 0.1                       # Cross-sectional area (m²)
rho = 1.225                   # Air density (kg/m³)
g = 9.81                      # Gravity (m/s²)

# Simulation parameters
time_final = 100              # Simulation time (s)
time_step = 0.1               # Time step for data collection (s)

# Define the equations of motion
def rocket_dynamics(t, y):
    altitude, velocity, mass = y
    if mass > (mass_initial - mass_fuel):  # During fuel burn
        fuel_mass_rate = burn_rate
        thrust_force = thrust
    else:  # After fuel is exhausted
        fuel_mass_rate = 0
        thrust_force = 0

    drag_force = 0.5 * rho * velocity**2 * Cd * A
    net_force = thrust_force - drag_force - mass * g
    acceleration = net_force / mass
    d_mass_dt = -fuel_mass_rate

    return [velocity, acceleration, d_mass_dt]

# Initial conditions
y0 = [0.0, 0.0, mass_initial]

# Solve ODEs
solution = solve_ivp(rocket_dynamics, [0, time_final], y0, t_eval=np.arange(0, time_final, time_step))

# Extract results
altitude = solution.y[0]
velocity = solution.y[1]
mass = solution.y[2]
time = solution.t

# Plot the results
plt.figure(figsize=(12, 8))

plt.subplot(3, 1, 1)
plt.plot(time, altitude, label='Altitude (m)')
plt.xlabel('Time (s)')
plt.ylabel('Altitude (m)')
plt.grid()
plt.legend()

plt.subplot(3, 1, 2)
plt.plot(time, velocity, label='Velocity (m/s)', color='orange')
plt.xlabel('Time (s)')
plt.ylabel('Velocity (m/s)')
plt.grid()
plt.legend()

plt.subplot(3, 1, 3)
plt.plot(time, mass, label='Mass (kg)', color='green')
plt.xlabel('Time (s)')
plt.ylabel('Mass (kg)')
plt.grid()
plt.legend()

plt.tight_layout()
plt.show()
```

---

### Explanation of the Code

- **ODE System**: The `rocket_dynamics` function defines the system of differential equations for altitude, velocity, and mass. The thrust decreases as fuel burns.
- **Fuel Burn Calculation**: When fuel is exhausted, the thrust is set to zero.
- **Numerical Integration**: The `solve_ivp` function integrates the ODEs over the time interval, collecting data points at each time step.
- **Plotting**: The altitude, velocity, and mass are plotted over time to analyze how the rocket behaves during launch.

---

### Interpreting the Results

1. **Altitude vs. Time**: This plot shows how high the rocket climbs. A rapid increase in altitude is expected during fuel burn, with a peak when fuel is exhausted.
2. **Velocity vs. Time**: This plot displays the changes in velocity, showing rapid acceleration initially and decreasing acceleration as drag and gravity balance the thrust.
3. **Mass vs. Time**: This plot indicates fuel consumption over time, with the mass steadily decreasing until all fuel is consumed.

### Enhancements
For a more advanced simulation:
- **Include variable air density**: Decrease air density with altitude to simulate real atmospheric conditions.
- **Introduce angular motion**: Account for non-vertical trajectories or off-vertical launches.
- **Implement a PID controller**: Simulate feedback control to adjust thrust direction for trajectory stability.

This basic simulation should provide valuable insights into the rocket’s behavior and help you understand key performance metrics, like maximum altitude and peak velocity. Let me know if you'd like more details on any specific aspect!